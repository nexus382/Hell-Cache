<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inner Sanctum Debug Menu Guide (Comprehensive Performance Edition)</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 20px;
            background: #0d1220;
            color: #e8ecf3;
            font-family: "Segoe UI", Tahoma, Arial, sans-serif;
            line-height: 1.45;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        h1, h2, h3, h4 {
            margin: 0 0 10px 0;
            color: #8dd6ff;
        }
        h4 {
            color: #b8c4dc;
            font-size: 15px;
            margin-top: 12px;
        }
        p {
            margin: 8px 0;
        }
        .card {
            background: #131a2b;
            border: 1px solid #253251;
            border-radius: 10px;
            padding: 16px;
            margin: 12px 0;
        }
        .meta {
            color: #b8c4dc;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        .pill {
            display: inline-block;
            padding: 3px 8px;
            border: 1px solid #3b537f;
            border-radius: 20px;
            color: #d6e7ff;
            background: #1a2540;
            margin-right: 6px;
            margin-top: 4px;
            font-size: 12px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: #101729;
            border: 1px solid #24304a;
        }
        th, td {
            border-bottom: 1px solid #24304a;
            border-right: 1px solid #24304a;
            padding: 12px;
            vertical-align: top;
            text-align: left;
            font-size: 13px;
        }
        th:last-child, td:last-child {
            border-right: none;
        }
        tr:last-child td {
            border-bottom: none;
        }
        th {
            background: #1b2742;
            color: #a9d7ff;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        .mono {
            font-family: Consolas, "Courier New", monospace;
            color: #c6f0ff;
            font-size: 12px;
        }
        .small {
            font-size: 13px;
            color: #b8c4dc;
        }
        .ok {
            color: #98f5b0;
            font-weight: 600;
        }
        .warn {
            color: #ffd28f;
        }
        .section-title {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 8px;
            flex-wrap: wrap;
        }
        .impact-high { color: #ff6b6b; font-weight: 600; }
        .impact-medium { color: #ffd28f; font-weight: 600; }
        .impact-low { color: #98f5b0; font-weight: 600; }
        .impacts { font-size: 11px; margin: 4px 0; }
        .tradeoffs {
            background: #1a2540;
            padding: 8px;
            border-radius: 6px;
            margin: 6px 0;
            font-size: 12px;
        }
        .tradeoffs-title {
            color: #ffd28f;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .use-cases {
            background: #0d4a6e;
            padding: 8px;
            border-radius: 6px;
            margin: 6px 0;
            font-size: 12px;
        }
        .use-cases-title {
            color: #8dd6ff;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .dev-notes {
            background: #2a1a3a;
            padding: 8px;
            border-radius: 6px;
            margin: 6px 0;
            font-size: 11px;
            color: #d6b8ff;
        }
        .visual-diff {
            background: #1a3a2a;
            padding: 8px;
            border-radius: 6px;
            margin: 6px 0;
            font-size: 12px;
        }
        .visual-diff-title {
            color: #98f5b0;
            font-weight: 600;
            margin-bottom: 4px;
        }
        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: 1fr;
            }
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
        .preset-table {
            font-size: 12px;
        }
        .preset-table td {
            padding: 8px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Inner Sanctum Debug Menu Guide</h1>
    <p class="meta">Comprehensive Performance & Tuning Guide - Code-verified against <span class="mono">app_full.lua</span></p>

    <div class="card">
        <h2>Quick Navigation</h2>
        <p><strong>55 Total Debug Settings</strong> across 3 pages with full performance impact analysis, use cases, and developer notes.</p>
        <p>
            <span class="pill">Core: 13 items</span>
            <span class="pill">Video: 24 items</span>
            <span class="pill">Perf/Q: 18 items</span>
        </p>
        <p class="small">
            <a href="#core-settings" style="color: #8dd6ff;">Core Page (DEBUG)</a> |
            <a href="#video-settings" style="color: #8dd6ff;">Video Page (VIDEO)</a> |
            <a href="#perfq-settings" style="color: #8dd6ff;">Perf/Q Page (PERF/Q)</a> |
            <a href="#performance-tips" style="color: #8dd6ff;">Performance Tips & Presets</a>
        </p>
    </div>

    <div class="card">
        <h2>Navigation & Input</h2>
        <div class="grid">
            <div>
                <p><span class="pill">UP/DOWN</span> Move cursor</p>
                <p><span class="pill">LEFT/RIGHT</span> Change settings (hold to repeat)</p>
                <p><span class="pill">A or MODE</span> Confirm BACK rows only</p>
                <p><span class="pill">B/POWER</span> Exit menu</p>
            </div>
            <div>
                <p class="small">Most toggles: RIGHT = ON, LEFT = OFF</p>
                <p class="small">Inverted labels (ENEMIES, PROPS, TEXTURES) use backing "disable" flags</p>
                <p class="small">Hold LEFT/RIGHT for 6 frames to repeat adjust</p>
            </div>
        </div>
    </div>

    <!-- CORE PAGE -->
    <div class="card" id="core-settings">
        <div class="section-title">
            <h2>Core Page (DEBUG)</h2>
            <span class="small">13 fundamental system controls</span>
        </div>
        <table>
            <thead>
            <tr>
                <th style="width: 30px;">#</th>
                <th style="width: 140px;">Menu Label</th>
                <th style="width: 140px;">Variables</th>
                <th>Values & Behavior</th>
                <th style="width: 380px;">Performance & Usage Guide</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td class="mono">PAGE</td>
                <td class="mono">titleDebugPage</td>
                <td>Cycles: DEBUG → VIDEO → PERF/Q → DEBUG</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Access different tuning categories<br>
                        • Navigate between debug pages
                    </div>
                </td>
            </tr>
            <tr>
                <td>2</td>
                <td class="mono">LOGS</td>
                <td class="mono">enableBootLogs<br>enablePerfLogs<br>DEBUG_WALL_QUADS_LOG</td>
                <td>RIGHT = ON (all 3 log flags), LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~2-5% when active</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Gain: Performance diagnostics, wall quad visibility, adaptive ray logging<br>
                        Lose: Frame time (string formatting, I/O), console clutter
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Debugging rendering issues or performance spikes<br>
                        • Tuning adaptive ray budget behavior<br>
                        • Analyzing wall quad patterns
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Logs write every 1 second (PERF_MONITOR_LOG_INTERVAL_US). PERF_MONITOR_ACTIVE_SAMPLE samples every 12 frames to reduce overhead.
                    </div>
                </td>
            </tr>
            <tr>
                <td>3</td>
                <td class="mono">ENEMIES</td>
                <td class="mono">DEBUG_DISABLE_ENEMIES<br>(inverse label)</td>
                <td>RIGHT = ON, LEFT = OFF (sets disable flag)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~15-25% when OFF</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        ON: Enemies spawn, path, attack, animate<br>
                        OFF: Empty corridors, no AI processing, no combat
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Gain: Massive performance boost (no AI, no collision, no sprite rendering)<br>
                        Lose: All gameplay, level becomes empty exploration only
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Benchmarking pure renderer performance<br>
                        • Taking screenshots without enemies<br>
                        • Testing level geometry/player movement isolated
                    </div>
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td class="mono">PROPS</td>
                <td class="mono">DEBUG_DISABLE_PROPS<br>(inverse label)</td>
                <td>RIGHT = ON, LEFT = OFF (resets cache)</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~5-12% when OFF</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        ON: Pickup items, barrels, torches, decorations visible<br>
                        OFF: Bare walls and floors, no interactive objects
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Gain: Fewer sprites to sort/render, reduced memory<br>
                        Lose: Visual detail, no items to collect, empty-feeling levels
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Performance testing focused on walls/enemies only<br>
                        • Speedrunning (find optimal routes without items)<br>
                        • Screenshotting architectural elements
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Setting OFF resets spriteOrderCache (sprite ordering optimization cache cleared).
                    </div>
                </td>
            </tr>
            <tr>
                <td>5</td>
                <td class="mono">BLOCK DBG</td>
                <td class="mono">DEBUG_SHOW_BLOCK</td>
                <td>RIGHT = ON (block overlay), LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~0.5-1% (text overlay)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Normal combat HUD<br>
                        ON: "BLOCK READY" / "BLOCK SUCCESS" / "BLOCK FAIL" text overlays during combat windows
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Tuning block timing windows<br>
                        • Learning combat mechanics<br>
                        • Debugging block detection issues
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Shows shield/block feedback text. Critical for balancing combat difficulty (player reflex vs enemy attack windup).
                    </div>
                </td>
            </tr>
            <tr>
                <td>6</td>
                <td class="mono">FPS TARGET</td>
                <td class="mono">FPS_TARGET_MODE</td>
                <td>Cycles: UNCAPPED → 60 → 45 → 30 → 24 → UNCAPPED</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: Controls pacing, not workload</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        UNCAPPED: Max framerate, varies with scene complexity<br>
                        60: Smooth motion, highest frame budget (16.67ms)<br>
                        45: Good balance, more headroom (22.22ms)<br>
                        30: Playable but choppy, large budget (33.33ms)<br>
                        24: Minimum acceptable, max budget (41.67ms)
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • UNCAPPED: Benchmarking, competitive play<br>
                        • 60: Best experience, fast devices<br>
                        • 45: Balanced performance/quality<br>
                        • 30: Slow devices, battery saving<br>
                        • 24: Absolute minimum playability
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Only affects render pacing (sleep duration). Adaptive ray budget uses these targets for downshift/upshift decisions (ADAPTIVE_RAY_DOWN_HYST_US, UP_HYST_US).
                    </div>
                </td>
            </tr>
            <tr>
                <td>7</td>
                <td class="mono">AUDIO MIX</td>
                <td class="mono">AUDIO_MIX_HZ_PRESETS<br>AUDIO_UPDATE_TARGET_HZ</td>
                <td>20-60 Hz in 5 Hz increments (9 presets)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~1-3% from 20→60 Hz</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        20 Hz: Most efficient, audio may stutter/crackle<br>
                        40 Hz: Good balance, smooth enough for most sounds<br>
                        60 Hz: Smoothest audio, highest CPU cost (3x vs 20 Hz)
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • 60 Hz: Music-focused gameplay, fast device<br>
                        • 40-45 Hz: Default balanced experience<br>
                        • 20-30 Hz: Performance critical, battery saving
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Controls audio mixer update frequency. Higher = smoother fade envelopes and effect transitions. Minimal impact on rendering pipeline.
                    </div>
                </td>
            </tr>
            <tr>
                <td>8</td>
                <td class="mono">RENDER</td>
                <td class="mono">lockRendererMode()<br>RENDERER_MODE<br>WALL_TEXTURE_MODE</td>
                <td>Not a toggle. Forces EXP-H lock + proper texture mode</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None (just re-applies)</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Recovery if renderer state corrupted<br>
                        • Ensuring EXP-H hybrid mode active<br>
                        • Debugging renderer mode drift
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Single renderer path locked to "exp_hybrid" + "proper" wall texture mode. Any LEFT/RIGHT press re-asserts this configuration. Historically supported multiple renderers; now locked for stability.
                    </div>
                </td>
            </tr>
            <tr>
                <td>9</td>
                <td class="mono">RAYCAST</td>
                <td class="mono">USE_FIXED_RAYCAST<br>DEBUG_FORCE_FLOAT_RAYCAST</td>
                <td>RIGHT = FIXED, LEFT = FLOAT</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~0-2% (path dependent)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        FIXED: Integer-based raycasting, deterministic, slightly faster<br>
                        FLOAT: Floating-point raycasting, A/B validation reference
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        FIXED: Faster on integer-only hardware, deterministic results<br>
                        FLOAT: Better precision, reference implementation
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • FIXED: Production, max performance<br>
                        • FLOAT: Debugging precision issues, A/B comparison
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> FIXED uses precomputed trig tables (castCos/castSin arrays). FLOAT uses vmupro.math cos/sin. For A/B validation of rendering correctness.
                    </div>
                </td>
            </tr>
            <tr>
                <td>10</td>
                <td class="mono">PERF MON</td>
                <td class="mono">DEBUG_PERF_MONITOR</td>
                <td>RIGHT = ON (overlay), LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~1-2% (overlay rendering)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Clean HUD<br>
                        ON: 8-line performance overlay (frame/raycast/wall/fog timing, mip distribution, dbuf stats)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Gain: Real-time visibility into bottlenecks (raycast vs wall vs fog), mip level usage, adaptive ray shifts<br>
                        Lose: Screen space, minor rendering cost
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Always during performance tuning<br>
                        • Debugging sudden frame drops<br>
                        • Verifying adaptive ray budget behavior<br>
                        • Optimizing mip level distribution
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Samples every 12 frames (PERF_MONITOR_SAMPLE_EVERY). Shows EMA (Exponential Moving Average) with alpha=0.25. Displays: frame time, raycast ms, wall ms, fog ms, column counts, ray preset shifts, double-buffer memory delta.
                    </div>
                </td>
            </tr>
            <tr>
                <td>11</td>
                <td class="mono">AUTO RAYS</td>
                <td class="mono">ADAPTIVE_RAY_BUDGET_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF (resets EMA/cooldown)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: +15-40% stability</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Fixed ray count, framerate varies wildly with scene<br>
                        ON: Ray count auto-adjusts to maintain target FPS (shows "60x4→48x5→60x4" shifts)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ON: Stable framerate, automatic quality scaling<br>
                        OFF: Consistent visual quality, framerate may dip in complex scenes
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended Combinations</div>
                        • AUTO RAYS ON + FPS TARGET 60 = Stable smooth gameplay<br>
                        • AUTO RAYS ON + FPS TARGET UNCAPPED = Max quality with ceiling<br>
                        • AUTO RAYS OFF + Manual RAYS = A/B testing specific presets
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Uses EMA (alpha=0.2) on frame time. Downshift threshold: target+2.2ms, upshift: target-2.6ms. 18-frame cooldown between shifts (ADAPTIVE_RAY_COOLDOWN_FRAMES). Never exceeds base preset index.
                    </div>
                </td>
            </tr>
            <tr>
                <td>12</td>
                <td class="mono">DBUF</td>
                <td class="mono">applyDoubleBufferMode()<br>DEBUG_DOUBLE_BUFFER<br>DOUBLE_BUFFER_ACTIVE</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">Memory Impact: +3-8 KB/frame buffer</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: May show tearing during fast camera movement<br>
                        ON: Smooth, no tearing, stable image
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ON: No tearing, smoother visual, extra memory overhead<br>
                        OFF: Saves memory, potential tearing on some devices
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • ON: Production, polished experience<br>
                        • OFF: Memory-constrained devices, testing tearing impact
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Calls startDoubleBufferRenderer() on enable. Tracks memory delta (DOUBLE_BUFFER_DELTA_USAGE_BYTES). Menu shows ON only when both flag AND active state true. Some devices may not support (falls back to OFF).
                    </div>
                </td>
            </tr>
            <tr>
                <td>13</td>
                <td class="mono">BACK</td>
                <td class="mono">applyDebugMenuSelection()</td>
                <td>A/MODE confirms, no LEFT/RIGHT effect</td>
                <td>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Exit debug menu and return to Options<br>
                        • Apply pending changes (though most apply immediately)
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- VIDEO PAGE -->
    <div class="card" id="video-settings">
        <div class="section-title">
            <h2>Video Page (VIDEO)</h2>
            <span class="small">24 rendering quality controls</span>
        </div>
        <table>
            <thead>
            <tr>
                <th style="width: 30px;">#</th>
                <th style="width: 120px;">Menu Label</th>
                <th style="width: 130px;">Variables</th>
                <th>Values & Behavior</th>
                <th>Performance & Usage Guide</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td class="mono">PAGE</td>
                <td class="mono">titleDebugPage</td>
                <td>Cycles: VIDEO → PERF/Q → DEBUG → VIDEO</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None</span></div>
                </td>
            </tr>
            <tr>
                <td>2</td>
                <td class="mono">TEXTURES</td>
                <td class="mono">DEBUG_DISABLE_WALL_TEXTURE<br>(inverse label)</td>
                <td>RIGHT = ON (loads), LEFT = OFF (unloads)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~20-35% when OFF</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        ON: Full textured walls (brick, stone, moss patterns)<br>
                        OFF: Flat shaded walls (solid colors only),大幅降低视觉质量
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        OFF: Massive performance gain, saves texture memory (~8-15 KB depending on assets)<br>
                        ON: Rich visual detail, immersive atmosphere
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • OFF: Absolute minimum spec, retro aesthetic<br>
                        • ON: Normal gameplay, screenshots
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Calls unloadWallTextures() on disable, loadWallTextures() on enable. 6 wall types + 6 tile sheets + roof texture.
                    </div>
                </td>
            </tr>
            <tr>
                <td>3</td>
                <td class="mono">ROOF TEX</td>
                <td class="mono">DEBUG_DISABLE_ROOF_TEXTURE<br>(inverse label)</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~2-5% when OFF</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        ON: Textured ceiling (dirt splatter pattern)<br>
                        OFF: Flat ceiling color
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        OFF: Small performance gain, saves ~1-2 KB<br>
                        ON: More complete atmosphere, especially when looking up
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • OFF: squeezing last bit of performance<br>
                        • ON: Normal gameplay
                    </div>
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td class="mono">MIPMAP</td>
                <td class="mono">WALL_MIPMAP_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~5-15% when properly tuned</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Crisp textures at all distances, more aliasing shimmer<br>
                        ON: Distance-tier texture reduction (MIP1-4), smoother distant surfaces
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ON: Reduced texture fetches at distance, smoother appearance<br>
                        OFF: Sharper distant textures, more GPU load, potential shimmering
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended Combinations</div>
                        • MIPMAP ON + MIP LOD ON + tight MIP distances = Best quality/perf balance<br>
                        • MIPMAP OFF = Debugging texture artifacts, retro crisp look
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Master toggle for entire mip system. Must be ON for MIP1-4 distance thresholds to have effect. Controls whether getMipLevelForDistance() is consulted during texture sampling.
                    </div>
                </td>
            </tr>
            <tr>
                <td>5</td>
                <td class="mono">MIP LOD</td>
                <td class="mono">MIP_LOD_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~3-10% when ON</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: MIPMAP enabled but all distances use MIP0 (full res)<br>
                        ON: Distance tiers active (MIP0→1→2→3→4 based on MIP1-4 DIST settings)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ON: Aggressive quality reduction at distance, major performance win<br>
                        OFF: Full res everywhere within draw distance, heavier
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • ON: All performance-critical scenarios<br>
                        • OFF: A/B testing, checking if mip distances are the bottleneck
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Controls whether configured MIP distance thresholds (WALL_MIPMAP_DIST1-4) are enforced. When OFF, MIPMAP can be ON but effectively disabled (all columns at MIP0).
                    </div>
                </td>
            </tr>
            <tr>
                <td>6</td>
                <td class="mono">RAYS</td>
                <td class="mono">RAY_PRESETS<br>RAY_PRESET_INDEX</td>
                <td>12x20 → 15x16 → 16x15 → 20x12 → 24x10 → 30x8 → 40x6 → 48x5 → 60x4 → 80x3 → 120x2 → 240x1</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~300% variance across presets</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Quality vs Performance</div>
                        12x20 (240 rays): Lowest quality, fastest (reference minimum)<br>
                        48x5 (240 rays): Baseline balanced preset<br>
                        60x4 (240 rays): Default quality preset<br>
                        80x3 (240 rays): High quality<br>
                        120x2 (240 rays): Very high quality<br>
                        240x1 (240 rays): Maximum quality, slowest
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • 12x20-30x8: Performance preset, slow devices<br>
                        • 48x5: Balanced preset (PERFORMANCE default)<br>
                        • 60x4-80x3: Balanced preset (BALANCED default)<br>
                        • 80x3-120x2: Quality preset<br>
                        • 240x1: Maximum quality (QUALITY targets nearest 120x2, not 240 due to diminishing returns)
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Total rays always 240 (rayCols × colW). More cols = wider FOV, better angular resolution. Fewer cols = faster per-column cost but more total columns. Adaptive mode may override selection at runtime (shows base->effective in menu).
                    </div>
                </td>
            </tr>
            <tr>
                <td>7</td>
                <td class="mono">DRAW DIST</td>
                <td class="mono">DRAW_DIST_PRESETS<br>EXP_TEX_MAX_DIST</td>
                <td>3 → 4 → 5 → 6 → 8 → 10 → 12 → 14 → 16 → 20 → 24 (units)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~40-60% variance (3 vs 24)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        3-6: Walls fade to black/fog very nearby, claustrophobic<br>
                        8-12: Balanced visibility, standard gameplay<br>
                        16-24: See far down corridors, more epic but expensive
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower: Massive performance win (fewer columns textured), intimate atmosphere<br>
                        Higher: Epic sightlines, more strategic info, heavier rendering
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Preset Mapping</div>
                        • QUALITY: 16 (max visibility)<br>
                        • BALANCED: 12 (good balance)<br>
                        • PERFORMANCE: 8 (visibility limited for speed)
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Controls EXP_TEX_MAX_DIST (texture cutoff). Also syncs FOG_START and FOG_END for smooth fade. Values beyond 16 have diminishing returns due to FOV and corridor geometry.
                    </div>
                </td>
            </tr>
            <tr>
                <td>8</td>
                <td class="mono">FAR TEX OFF</td>
                <td class="mono">FAR_TEX_OFF_PRESETS<br>FAR_TEX_OFF_DIST</td>
                <td>3-24, then OFF (999). Hard cutoff for textures.</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~10-20% when set to 8-12</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Textures extend to draw distance limit<br>
                        10: Textures cut at 10 units, geometry continues (flat shading beyond)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Setting to 8-12: Keep nearby detail, kill far texture fetches<br>
                        OFF: Max texture coverage everywhere
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • 8-12: Performance tuning - keep near textures visible<br>
                        • OFF: Max quality
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Hard cutoff independent of fog. Can create visual discontinuity if not aligned with fog settings. Use FOG CUT L for smoother silhouette-preserving cutoff. FAR_TEX_OFF=999 means OFF.
                    </div>
                </td>
            </tr>
            <tr>
                <td>9</td>
                <td class="mono">MIP1 DIST</td>
                <td class="mono">MIPMAP1_DIST_INDEX<br>WALL_MIPMAP_DIST1</td>
                <td>1.5-24 (19 presets). Clamped < MIP2.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~2-5% per tier shift</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        Lower (2-3): MIP reduction kicks in very early, aggressive<br>
                        Higher (5-8): MIP reduction delayed, sharper near-mid textures
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower: More aggressive LOD, better performance<br>
                        Higher: Sharper textures at medium range
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Start at 4.0 (default)<br>
                        • Lower if distant textures are too sharp (wasting perf)<br>
                        • Raise if medium-distance textures look too blurry
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> First mip level threshold. Distance at which walls transition from MIP0 (full res) to MIP1 (1/2 res). Clamped to stay < MIP2_DIST.
                    </div>
                </td>
            </tr>
            <tr>
                <td>10</td>
                <td class="mono">MIP2 DIST</td>
                <td class="mono">MIPMAP2_DIST_INDEX<br>WALL_MIPMAP_DIST2</td>
                <td>1.5-24. Clamped between MIP1+1 and MIP3-1.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~2-5% per tier shift</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Tuning Strategy</div>
                        Default: 4.5 (slightly after MIP1 at 4.0)<br>
                        Spread out MIP1-2-3-4 for smoother gradient<br>
                        Bunch them for sharper transitions (more visual popping)
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Second mip threshold. MIP1→MIP2 transition. Controls mid-distance quality. Must be at least 1 step above MIP1 in preset array.
                    </div>
                </td>
            </tr>
            <tr>
                <td>11</td>
                <td class="mono">MIP3 DIST</td>
                <td class="mono">MIPMAP3_DIST_INDEX<br>WALL_MIPMAP_DIST3</td>
                <td>1.5-24. Clamped between MIP2 and MIP4.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~2-5% per tier shift</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Tuning Strategy</div>
                        Default: 8.0 (larger jump, aggressive far-distance LOD)<br>
                        Lower (6-7): Earlier reduction for distant walls<br>
                        Higher (10-12): Delay far LOD for sharper distance view
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Third mip threshold. MIP2→MIP3 transition. Controls far-distance quality. Default 8.0 creates large gap from MIP2 (4.5), pushing aggressive LOD to distance.
                    </div>
                </td>
            </tr>
            <tr>
                <td>12</td>
                <td class="mono">MIP4 DIST</td>
                <td class="mono">MIPMAP4_DIST_INDEX<br>WALL_MIPMAP_DIST4</td>
                <td>1.5-24. Clamped > MIP3.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~2-5% per tier shift</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Tuning Strategy</div>
                        Default: 10.0 (minimum quality beyond 10 units)<br>
                        Lower: Activate maximum LOD earlier<br>
                        Higher: Delay minimum LOD
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Fourth/final mip threshold. MIP3→MIP4 transition. Beyond this distance, walls use minimum resolution. Default 10.0 means max LOD at 3/4 of BALANCED draw distance (12).
                    </div>
                </td>
            </tr>
            <tr>
                <td>13</td>
                <td class="mono">FOG START</td>
                <td class="mono">FOG_START_PRESETS<br>FOG_START</td>
                <td>2.0-28.0 (29 presets). Enforced < FOG FULL.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~1-3% (fog overlay cost)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        Lower (6-8): Fog starts nearby, claustrophobic, heavy atmosphere<br>
                        Higher (12-16): Clear near-mid vision, fog only at distance
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower: Stronger atmosphere, hides distant rendering artifacts<br>
                        Higher: Better visibility, more tactical information
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended Settings</div>
                        • 10-11: Balanced (near-clear, distance fade)<br>
                        • 8-9: Atmospheric, horror mood<br>
                        • 13-14: Bright environments, less fog
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Distance at which fog fade-in begins. Default 10.0. Creates smooth transition from clear (START) to opaque (FULL). Must be < FOG_END.
                    </div>
                </td>
            </tr>
            <tr>
                <td>14</td>
                <td class="mono">FOG FULL</td>
                <td class="mono">FOG_END_PRESETS<br>FOG_END</td>
                <td>2.0-28.0. Enforced > FOG START.</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~1-3%</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        Lower (10-12): Walls fade to fog color earlier, shorter draw<br>
                        Higher (16-20): Full visibility to fog point, longer sightlines
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower: Hides more geometry/texture work, saves perf<br>
                        Higher: See further, more expensive
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended Settings</div>
                        • 13-14: Balanced (matches FOG START 10-11)<br>
                        • 11-12: Dense fog, intimate scale<br>
                        • 16+: Epic corridors, expensive
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Distance at which fog becomes fully opaque (solid color). Default 13.0 creates 3-unit fade zone from START (10.0). syncFogToDrawDistance() maintains proportional relationship.
                    </div>
                </td>
            </tr>
            <tr>
                <td>15</td>
                <td class="mono">FOG CUT L</td>
                <td class="mono">FOG_CUTOFF_PRESETS<br>FOG_TEX_CUTOFF</td>
                <td>2.0-28.0. Texture-only cutoff, geometry continues.</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~10-15% when set to 8-12</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        10: Beyond 10 units, geometry visible but flat-shaded (no textures)<br>
                        24+: Textures extend to geometry limit
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower (8-12): Keep silhouettes, kill expensive texture fetches<br>
                        Higher: Full texturing to distance
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • 8-12: Performance tuning - silhouette-preserving optimization<br>
                        • 20+: Near-max quality
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Legacy setting from before EXP-H fog fade. Now used as texture cutoff independent of fog opacity. Can create flat-shaded distant walls (geometry visible, textured surface disabled). More visually pleasing than FAR TEX OFF for silhouette work.
                    </div>
                </td>
            </tr>
            <tr>
                <td>16</td>
                <td class="mono">FOG COLOR</td>
                <td class="mono">FOG_COLOR_LABELS<br>FOG_COLOR_PRESETS</td>
                <td>DARK → GRAY → LGRAY → WHITE → BLACK → MAROON</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        DARK: Dark gray haze, dungeon atmosphere (default)<br>
                        GRAY: Bright haze, overcast feel<br>
                        WHITE: Thick white mist, horror vibe<br>
                        BLACK: Void darkness, maximum contrast<br>
                        MAROON: Blood/red fog, hellish/danger mood
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • DARK: Standard dungeon gameplay<br>
                        • WHITE: Horror/haunting levels<br>
                        • BLACK: High contrast, dramatic lighting<br>
                        • MAROON: Hell/danger themes
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Purely aesthetic. Uses predefined COLOR_* constants. No performance impact. Dither pattern overlays this color.
                    </div>
                </td>
            </tr>
            <tr>
                <td>17</td>
                <td class="mono">FOG DTHR</td>
                <td class="mono">FOG_DITHER_SIZE_PRESETS<br>FOG_DITHER_SIZE</td>
                <td>1 → 2 → 3 → 4 → 5 → 6 (pixel grid size)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~0-1% (dither rendering)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        1-2: Fine stipple pattern, smooth gradient, may show banding at distance<br>
                        3-4: Balanced stipple, good gradient smoothness (default)<br>
                        5-6: Coarse dither, visible stippling, retro aesthetic
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        Lower (1-2): Smoother appearance, more calculation per pixel<br>
                        Higher (5-6): Faster, visible "stippled" look, retro feel
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Preset Mapping</div>
                        • QUALITY: 2 (fine dither)<br>
                        • BALANCED: 3 (balanced)<br>
                        • PERFORMANCE: 4 (coarse stipple)
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Controls fog dither matrix size. Larger values = coarser stipple pattern but less per-pixel work. Dither prevents banding in fog gradient. Implementation uses sparse stippling (not every pixel drawn).
                    </div>
                </td>
            </tr>
            <tr>
                <td>18</td>
                <td class="mono">WALL RES</td>
                <td class="mono">LOW_RES_MODE</td>
                <td>RIGHT = QUALITY, LEFT = FAST</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~5-10% (via ray preset bias)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        QUALITY: RAYS preset used directly (60x4 = 60 rays at 4px width)<br>
                        FAST: RAYS preset biased -1 step (60x4 behaves like 48x5)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        QUALITY: Full selected ray resolution<br>
                        FAST: Automatic 1-step quality reduction for performance
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • QUALITY: All normal gameplay (QUALITY/BALANCED presets)<br>
                        • FAST: PERFORMANCE preset, slow devices
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> When FAST, getBaseEffectiveRayPresetIndex() subtracts 1 from RAY_PRESET_INDEX (minimum 1). Creates "effective" ray preset lower than selected. Menu shows base->effective (e.g., "80x3->60x4").
                    </div>
                </td>
            </tr>
            <tr>
                <td>19</td>
                <td class="mono">FPS OVL</td>
                <td class="mono">showFpsOverlay</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~0.5% (text rendering)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: Clean HUD<br>
                        ON: Current FPS display in corner
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Always during tuning/benchmarking<br>
                        • OFF for final screenshots/streaming
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Simple FPS counter. Less detailed than PERF MON but non-intrusive. Good for quick framerate checks.
                    </div>
                </td>
            </tr>
            <tr>
                <td>20</td>
                <td class="mono">MINIMAP</td>
                <td class="mono">SHOW_MINIMAP</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~3-8% when ON</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        OFF: No radar, exploration more challenging<br>
                        ON: Top-down radar showing walls, player position, nearby entities
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ON: Navigation aid, tactical awareness, performance cost<br>
                        OFF: Harder exploration, faster rendering
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • ON: New players, complex levels, speedrunning route planning<br>
                        • OFF: Hardcore mode, performance testing, screenshots
                    </div>
                </td>
            </tr>
            <tr>
                <td>21</td>
                <td class="mono">WALL1 FMT</td>
                <td class="mono">WALL1_FORMAT_VARIANTS<br>WALL1_FORMAT_INDEX</td>
                <td>Cycles format variants (reloads textures)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None (same resolution)</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • A/B testing different texture compression formats<br>
                        • Development/testing (currently only PNG16 available)
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Current build has single variant: PNG16 (128x256 base, 1x128 sheet frames). Additional variants would be: RLET, raw bitmap, etc. Hot-reloads textures if TEXTURES enabled.
                    </div>
                </td>
            </tr>
            <tr>
                <td>22</td>
                <td class="mono">WALL KEY</td>
                <td class="mono">WALL_FORCE_COLORKEY_OVERRIDE</td>
                <td>RIGHT = FORCED (0x0000), LEFT = RAW source key</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        RAW: Uses transparency color from sprite metadata (artist-defined)<br>
                        FORCED: Overrides to pure black (0x0000) transparency
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • FORCED: Debugging accidental transparency, ensuring consistent keying<br>
                        • RAW: Normal gameplay, asset-accurate transparency
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> TEX_FORCE_COLORKEY = 0x0000. Hot-reloads textures on change. Useful for diagnosing walls that appear "ghostly" due to incorrect transparent color in source assets.
                    </div>
                </td>
            </tr>
            <tr>
                <td>23</td>
                <td class="mono">WALL PROJ</td>
                <td class="mono">WALL_PROJECTION_MODE</td>
                <td>RIGHT = ADAPTIVE, LEFT = STABLE</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None (projection method)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        ADAPTIVE: Projection mode varies per column based on angle/geometry<br>
                        STABLE: Consistent projection mode, predictable appearance
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        ADAPTIVE: May look better in edge cases, but inconsistent<br>
                        STABLE: Predictable for A/B testing, consistent artifacts
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • ADAPTIVE: Production (may handle edge cases better)<br>
                        • STABLE: Debugging, A/B comparison, predictable visuals
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Controls texture projection algorithm. ADAPTIVE may switch between techniques based on wall angle/distance. STABLE locks to single method for consistency.
                    </div>
                </td>
            </tr>
            <tr>
                <td>24</td>
                <td class="mono">BACK</td>
                <td class="mono">applyDebugMenuSelection()</td>
                <td>A/MODE confirms</td>
                <td>
                    <div class="use-cases">
                        Exit debug menu, return to Options
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- PERF/Q PAGE -->
    <div class="card" id="perfq-settings">
        <div class="section-title">
            <h2>Perf/Q Page (PERF/Q)</h2>
            <span class="small">18 quality preset + UI controls</span>
        </div>

        <div class="card" style="margin: 8px 0; background: #1a2540;">
            <h3>Preset Quick Reference</h3>
            <table class="preset-table">
                <thead>
                <tr>
                    <th>Preset</th>
                    <th>WALL RES</th>
                    <th>RAYS</th>
                    <th>DRAW DIST</th>
                    <th>FAR TEX OFF</th>
                    <th>MIPMAP</th>
                    <th>MIP LOD</th>
                    <th>FOG DTHR</th>
                    <th>AUTO RAYS</th>
                    <th>Best For</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="mono" style="color: #98f5b0;">QUALITY</td>
                    <td>quality</td>
                    <td>120x2 (max)</td>
                    <td>16 (max)</td>
                    <td>OFF</td>
                    <td>ON</td>
                    <td>ON</td>
                    <td>2 (fine)</td>
                    <td>ON</td>
                    <td>Fast devices, screenshots</td>
                </tr>
                <tr>
                    <td class="mono" style="color: #ffd28f;">BALANCED</td>
                    <td>quality</td>
                    <td>80x3</td>
                    <td>12</td>
                    <td>16</td>
                    <td>ON</td>
                    <td>ON</td>
                    <td>3 (medium)</td>
                    <td>ON</td>
                    <td>Most gameplay</td>
                </tr>
                <tr>
                    <td class="mono" style="color: #ff6b6b;">PERFORMANCE</td>
                    <td>fast</td>
                    <td>48x5</td>
                    <td>8</td>
                    <td>10</td>
                    <td>ON</td>
                    <td>ON</td>
                    <td>4 (coarse)</td>
                    <td>ON</td>
                    <td>Slow devices, battery saving</td>
                </tr>
                </tbody>
            </table>
            <p class="small">Applying any preset resets adaptive state and re-syncs fog/draw distance. Manual overrides show "CUSTOM".</p>
        </div>

        <table>
            <thead>
            <tr>
                <th style="width: 30px;">#</th>
                <th style="width: 120px;">Menu Label</th>
                <th style="width: 130px;">Variables</th>
                <th>Values & Behavior</th>
                <th>Performance & Usage Guide</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td class="mono">PAGE</td>
                <td class="mono">titleDebugPage</td>
                <td>Cycles: PERF/Q → VIDEO → DEBUG → PERF/Q</td>
                <td><span class="impact-low">FPS Impact: None</span></td>
            </tr>
            <tr>
                <td>2</td>
                <td class="mono">P/Q PRESET</td>
                <td class="mono">PERF_QUALITY_PRESETS<br>PERF_QUALITY_INDEX<br>applyPerfQualityPreset()</td>
                <td>QUALITY → BALANCED → PERFORMANCE → (manual = CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~50-80% variance (PERF vs QUALITY)</span></div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Preset Trade-offs</div>
                        QUALITY: Max visual fidelity, highest CPU/memory cost<br>
                        BALANCED: 70% of quality for 40% of cost (best value)<br>
                        PERFORMANCE: Minimum viable quality, maximum framerate
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • QUALITY: Desktop play, screenshots, benchmarking<br>
                        • BALANCED: Default for most players/devices<br>
                        • PERFORMANCE: Low-end hardware, battery conservation
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Calls nearestRayPresetIndex() and nearestPresetIndex() to find closest matching preset. Resets ADAPTIVE_RAY_RUNTIME_INDEX, EMA, cooldown. Calls syncFogToDrawDistance() and normalizeMipmapRanges() for consistency.
                    </div>
                </td>
            </tr>
            <tr>
                <td>3</td>
                <td class="mono">WALL RES</td>
                <td class="mono">LOW_RES_MODE</td>
                <td>RIGHT = QUALITY, LEFT = FAST (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~5-10%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Override</div>
                        • Choose FAST with BALANCED preset for extra headroom<br>
                        • Choose QUALITY with PERFORMANCE preset for sharpness
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Same control as VIDEO page but lives here for convenience. Changing marks preset as CUSTOM (auto-detects manual override).
                    </div>
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td class="mono">RAYS</td>
                <td class="mono">RAY_PRESET_INDEX</td>
                <td>Same 12 presets as VIDEO page (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~300% variance</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Start with preset (QUALITY=120, BALANCED=80, PERF=48)<br>
                        • Lower if framerate unstable even with AUTO RAYS ON<br>
                        • Raise if visual quality insufficient
                    </div>
                </td>
            </tr>
            <tr>
                <td>5</td>
                <td class="mono">AUTO RAYS</td>
                <td class="mono">ADAPTIVE_RAY_BUDGET_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF (resets, marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: +15-40% stability</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Override</div>
                        • OFF: A/B testing specific ray presets, disabling auto-adjustment<br>
                        • ON: Most gameplay scenarios (enabled in all presets)
                    </div>
                </td>
            </tr>
            <tr>
                <td>6</td>
                <td class="mono">DRAW DIST</td>
                <td class="mono">DRAW_DIST_PRESETS<br>EXP_TEX_MAX_DIST</td>
                <td>3-24 (syncs fog, marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-high">FPS Impact: ~40-60% variance</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Lower preset DRAW DIST if FPS drops in complex scenes<br>
                        • syncFogToDrawDistance() automatically adjusts fog for smooth fade
                    </div>
                </td>
            </tr>
            <tr>
                <td>7</td>
                <td class="mono">FAR TEX OFF</td>
                <td class="mono">FAR_TEX_OFF_PRESETS<br>FAR_TEX_OFF_DIST</td>
                <td>3-24, OFF=999 (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~10-20% when aggressive (8-12)</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Set to 8-12 to keep near textures visible while killing far texture work<br>
                        • normalizeFarTextureCutoff() ensures it respects DRAW DIST
                    </div>
                </td>
            </tr>
            <tr>
                <td>8</td>
                <td class="mono">MIPMAP</td>
                <td class="mono">WALL_MIPMAP_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~5-15%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Override</div>
                        • OFF: Debugging texture artifacts, checking if mip LOD is causing issues<br>
                        • ON: All performance-critical gameplay (enabled in all presets)
                    </div>
                </td>
            </tr>
            <tr>
                <td>9</td>
                <td class="mono">MIP LOD</td>
                <td class="mono">MIP_LOD_ENABLED</td>
                <td>RIGHT = ON, LEFT = OFF (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~3-10%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Override</div>
                        • OFF: Force all columns to MIP0 (full resolution) for debugging<br>
                        • ON: Enable distance-tier quality reduction
                    </div>
                </td>
            </tr>
            <tr>
                <td>10</td>
                <td class="mono">FOG START</td>
                <td class="mono">FOG_START_PRESETS<br>FOG_START</td>
                <td>2.0-28.0 (enforced < FOG FULL, marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~1-3%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Adjust for atmosphere (lower = denser, more claustrophobic)<br>
                        • Keep 2-3 unit gap from FOG FULL for smooth fade
                    </div>
                </td>
            </tr>
            <tr>
                <td>11</td>
                <td class="mono">FOG FULL</td>
                <td class="mono">FOG_END_PRESETS<br>FOG_END</td>
                <td>2.0-28.0 (enforced > FOG START, marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~1-3%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • Lower to hide distant geometry/texture work (saves perf)<br>
                        • Higher for longer sightlines
                    </div>
                </td>
            </tr>
            <tr>
                <td>12</td>
                <td class="mono">FOG DTHR</td>
                <td class="mono">FOG_DITHER_SIZE_PRESETS<br>FOG_DITHER_SIZE</td>
                <td>1-6 (marks CUSTOM)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: ~0-1%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">Tuning Strategy</div>
                        • 1-2: Smooth gradient, may show banding<br>
                        • 3-4: Balanced (default)<br>
                        • 5-6: Coarse stipple, retro look, faster
                    </div>
                </td>
            </tr>
            <tr>
                <td>13</td>
                <td class="mono">UI TRANSP</td>
                <td class="mono">UI_TRANSPARENCY_PRESETS<br>UI_TRANSPARENCY_INDEX</td>
                <td>15 → 25 → 35 → 45 → 55 → 65 (%)</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None (UI only)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        15%: Mostly solid panels, minimal see-through<br>
                        35%: Default balanced transparency<br>
                        65%: Highly transparent, faint panels, game visible behind menus
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • 15-25: Bright environments, readability focus<br>
                        • 35-45: Default, most scenarios<br>
                        • 55-65: Dark environments, cinematic feel, keeping game visible
                    </div>
                    <div class="dev-notes">
                        <strong>DEV:</strong> Simulated transparency via sparse stippling (not true alpha). Higher % = fewer stipple pixels drawn. UI_TEXT_BG_TRANSPARENT setting works with this for complete transparency effect.
                    </div>
                </td>
            </tr>
            <tr>
                <td>14</td>
                <td class="mono">UI TXT BG</td>
                <td class="mono">UI_TEXT_BG_TRANSPARENT</td>
                <td>RIGHT = CLEAR, LEFT = SOLID</td>
                <td>
                    <div class="impacts"><span class="impact-low">FPS Impact: None (may slightly improve by not drawing text bg)</span></div>
                    <div class="visual-diff">
                        <div class="visual-diff-title">Visual Before/After</div>
                        SOLID: Text has colored background block (high legibility)<br>
                        CLEAR: Text floats, game visible behind (more immersive)
                    </div>
                    <div class="tradeoffs">
                        <div class="tradeoffs-title">Trade-offs</div>
                        CLEAR: More immersive, harder to read in bright areas<br>
                        SOLID: Maximum legibility, blocks more of game view
                    </div>
                    <div class="use-cases">
                        <div class="use-cases-title">Recommended For</div>
                        • CLEAR: Dark environments, high UI_TRANSP, cinematic feel<br>
                        • SOLID: Bright environments, low UI_TRANSP, competitive play
                    </div>
                </td>
            </tr>
            <tr>
                <td>15</td>
                <td class="mono">FPS TARGET</td>
                <td class="mono">FPS_TARGET_MODE</td>
                <td>UNCAPPED → 60 → 45 → 30 → 24</td>
                <td>
                    <div class="impacts"><span class="impact-high">Controls pacing, see Core #6 for details</span></div>
                </td>
            </tr>
            <tr>
                <td>16</td>
                <td class="mono">PERF MON</td>
                <td class="mono">DEBUG_PERF_MONITOR</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">FPS Impact: ~1-2%</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Essential while tuning Perf/Q settings<br>
                        • See real-time impact of manual overrides
                    </div>
                </td>
            </tr>
            <tr>
                <td>17</td>
                <td class="mono">DBUF</td>
                <td class="mono">applyDoubleBufferMode()</td>
                <td>RIGHT = ON, LEFT = OFF</td>
                <td>
                    <div class="impacts"><span class="impact-medium">Memory Impact: +3-8 KB/frame buffer</span></div>
                    <div class="use-cases">
                        <div class="use-cases-title">When To Use</div>
                        • Test memory/perf tradeoff with PERF MON visible<br>
                        • Check DOUBLE_BUFFER_DELTA_USAGE_BYTES in overlay
                    </div>
                </td>
            </tr>
            <tr>
                <td>18</td>
                <td class="mono">BACK</td>
                <td class="mono">applyDebugMenuSelection()</td>
                <td>A/MODE confirms</td>
                <td>Exit debug menu</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- PERFORMANCE TIPS -->
    <div class="card" id="performance-tips">
        <h2>Performance Tips & Recommended Presets</h2>

        <h3>Scenario-Based Presets</h3>
        <table>
            <thead>
            <tr>
                <th style="width: 180px;">Scenario</th>
                <th>Recommended Settings</th>
                <th>Expected FPS Improvement</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="mono" style="color: #ff6b6b;">Maximum Performance</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> PERFORMANCE<br>
                        <strong>Core:</strong> ENEMIES OFF (if exploring), PROPS OFF, AUTO RAYS ON<br>
                        <strong>Video:</strong> TEXTURES optional, MIPMAP ON, MIP LOD ON<br>
                        <strong>Additional:</strong> FAR TEX OFF 8, FOG START 8, FOG FULL 11
                    </div>
                </td>
                <td>
                    <span class="ok">+80-120% vs QUALITY</span><br>
                    <span class="small">Best for: Slow devices, battery saving</span>
                </td>
            </tr>
            <tr>
                <td class="mono" style="color: #ffd28f;">Balanced Gameplay</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> BALANCED (recommended default)<br>
                        <strong>Core:</strong> AUTO RAYS ON, FPS TARGET 60<br>
                        <strong>Video:</strong> TEXTURES ON, MIPMAP ON, MIP LOD ON<br>
                        <strong>Additional:</strong> DBUF ON
                    </div>
                </td>
                <td>
                    <span class="ok">Baseline (0% reference)</span><br>
                    <span class="small">Best for: Most players, good quality/perf ratio</span>
                </td>
            </tr>
            <tr>
                <td class="mono" style="color: #98f5b0;">Maximum Quality</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> QUALITY<br>
                        <strong>Core:</strong> AUTO RAYS ON, FPS TARGET UNCAPPED<br>
                        <strong>Video:</strong> TEXTURES ON, MIPMAP ON, MIP LOD ON, DRAW DIST 16<br>
                        <strong>Additional:</strong> FAR TEX OFF OFF, FOG DTHR 2, DBUF ON
                    </div>
                </td>
                <td>
                    <span class="warn">-50% vs BALANCED</span><br>
                    <span class="small">Best for: Fast devices, screenshots, competitive play</span>
                </td>
            </tr>
            <tr>
                <td class="mono">Benchmarking</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> QUALITY<br>
                        <strong>Core:</strong> ENEMIES OFF, PROPS OFF, AUTO RAYS OFF<br>
                        <strong>Video:</strong> RAYS 240x1 (maximum), TEXTURES ON<br>
                        <strong>Additional:</strong> PERF MON ON, FPS TARGET UNCAPPED
                    </div>
                </td>
                <td>
                    <span class="small">Pure renderer stress test</span><br>
                    <span class="small">Best for: profiling, optimization work</span>
                </td>
            </tr>
            <tr>
                <td class="mono">Speedrunning</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> BALANCED or PERFORMANCE<br>
                        <strong>Core:</strong> ENEMIES ON, FPS TARGET 60, AUTO RAYS ON<br>
                        <strong>Video:</strong> MINIMAP ON (route planning), TEXTURES ON<br>
                        <strong>Additional:</strong> DBUF ON (no tearing distractions)
                    </div>
                </td>
                <td>
                    <span class="small">Stable 60 FPS priority</span><br>
                    <span class="small">Best for: Competitive timing, consistency</span>
                </td>
            </tr>
            <tr>
                <td class="mono">Screenshots/Streaming</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> QUALITY<br>
                        <strong>Core:</strong> FPS OVL OFF, PERF MON OFF<br>
                        <strong>Video:</strong> TEXTURES ON, FOG COLOR artistic choice<br>
                        <strong>UI:</strong> UI TRANSP 65%, UI TXT BG CLEAR
                    </div>
                </td>
                <td>
                    <span class="small">Maximum visual fidelity</span><br>
                    <span class="small">Best for: Content creation, aesthetics</span>
                </td>
            </tr>
            <tr>
                <td class="mono">Retro/Crisp Aesthetic</td>
                <td>
                    <div class="small">
                        <strong>Preset:</strong> CUSTOM<br>
                        <strong>Video:</strong> MIPMAP OFF, MIP LOD OFF, TEXTURES ON<br>
                        <strong>Additional:</strong> RAYS 120x2 or higher, FOG COLOR BLACK
                    </div>
                </td>
                <td>
                    <span class="warn">Heavier rendering (no LOD)</span><br>
                    <span class="small">Best for: Pixel-art crispness, retro feel</span>
                </td>
            </tr>
            </tbody>
        </table>

        <h3>Settings to Avoid Changing Together</h3>
        <table>
            <thead>
            <tr>
                <th style="width: 200px;">Conflicting Settings</th>
                <th>Why They Conflict</th>
                <th>Recommended Approach</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="mono">MIPMAP OFF + MIP LOD ON</td>
                <td>MIP LOD requires MIPMAP to be active. When MIPMAP is OFF, MIP LOD has no effect (all walls at MIP0).</td>
                <td>Keep both ON for performance. Turn both OFF for debugging. Avoid mixed state.</td>
            </tr>
            <tr>
                <td class="mono">AUTO RAYS OFF + High RAY preset</td>
                <td>Without AUTO RAYS, framerate may become unstable in complex scenes with high ray counts.</td>
                <td>Either use AUTO RAYS ON, or manually select a lower ray preset if turning AUTO off.</td>
            </tr>
            <tr>
                <td class="mono">DRAW DIST 16-24 + Low RAYS</td>
                <td>High draw distance with low ray resolution looks poor (blocky distant walls waste draw budget).</td>
                <td>Match draw distance to ray quality: 8-12 with low rays, 16+ with high rays (80x3+).</td>
            </tr>
            <tr>
                <td class="mono">FAR TEX OFF + FOG CUT L</td>
                <td>Both cut textures at distance. May create visual discontinuity if not aligned.</td>
                <td>Use one or the other, or align values (FAR_TEX_OFF 12, FOG_CUT_L 12).</td>
            </tr>
            <tr>
                <td class="mono">WALL RES FAST + RAYS 240x1</td>
                <td>FAST biases rays -1 step, negating the 240x1 selection (shows 120x2).</td>
                <td>Use WALL RES QUALITY with high ray presets. FAST intended for PERFORMANCE preset.</td>
            </tr>
            <tr>
                <td class="mono">FOG START ≥ FOG FULL</td>
                <td>Enforced ordering prevents invalid config. Menu will clamp to maintain START < FULL.</td>
                <td>Keep 2-4 unit gap for smooth fade (START 10, FULL 13).</td>
            </tr>
            </tbody>
        </table>

        <h3>Hidden Interactions & Side Effects</h3>
        <table>
            <thead>
            <tr>
                <th style="width: 200px;">Setting</th>
                <th>Hidden Interactions</th>
                <th>Developer Notes</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="mono">P/Q PRESET</td>
                <td>Applying preset resets: ADAPTIVE_RAY_RUNTIME_INDEX, ADAPTIVE_RAY_EMA_US, ADAPTIVE_RAY_COOLDOWN. Also calls syncFogToDrawDistance() and normalizeMipmapRanges().</td>
                <td>Always re-applies fresh state. Adaptive system "forgets" previous performance after preset change.</td>
            </tr>
            <tr>
                <td class="mono">AUTO RAYS</td>
                <td>Toggling resets adaptive state (EMA, cooldown). Takes ~18 frames (cooldown) to begin adjusting again.</td>
                <td>Prevents rapid cycling. EMA alpha=0.2 means ~5 frames to settle on new frame time baseline.</td>
            </tr>
            <tr>
                <td class="mono">RAYS (VIDEO page)</td>
                <td>Changing resets ADAPTIVE_RAY_RUNTIME_INDEX to nil. Adaptive mode restarts from new base.</td>
                <td>May cause brief quality fluctuation as adaptive system re-learns frame time for new preset.</td>
            </tr>
            <tr>
                <td class="mono">DRAW DIST</td>
                <td>Calls syncFogToDrawDistance() which adjusts FOG_START and FOG_END proportionally.</td>
                <td>Maintains smooth fog fade regardless of draw distance. Prevents "hard" fog walls.</td>
            </tr>
            <tr>
                <td class="mono">MIP1-4 DIST</td>
                <td>Clamped to maintain ordering: MIP1 < MIP2 < MIP3 < MIP4. Menu enforces step distance in preset array.</td>
                <td>Prevents invalid LOD configurations. normalizeMipmapRanges() called on preset apply.</td>
            </tr>
            <tr>
                <td class="mono">TEXTURES (toggle)</td>
                <td>Calls unloadWallTextures() or loadWallTextures(). Force-reloads all 6 wall + 6 sheet + roof assets.</td>
                <td>Slight hitch when enabling (asset loading). ~8-15 KB texture memory restored.</td>
            </tr>
            <tr>
                <td class="mono">WALL1 FMT / WALL KEY</td>
                <td>Both trigger hot-reload if TEXTURES enabled. unloadWallTextures() then loadWallTextures().</td>
                <td>For development/debugging. Use sparingly during gameplay (causes texture hitch).</td>
            </tr>
            <tr>
                <td class="mono">PROPS</td>
                <td>Setting OFF resets spriteOrderCache (sprite ordering optimization cache cleared).</td>
                <td>Next frame will rebuild cache. May cause brief performance dip on first frame after disable.</td>
            </tr>
            <tr>
                <td class="mono">DBUF</td>
                <td>Tracks DOUBLE_BUFFER_DELTA_USAGE_BYTES (memory difference between ON and OFF states).</td>
                <td>Requires hardware support. Falls back gracefully if startDoubleBufferRenderer() fails.</td>
            </tr>
            <tr>
                <td class="mono">FPS TARGET</td>
                <td>Affects adaptive ray thresholds (ADAPTIVE_RAY_DOWN_HYST_US, UP_HYST_US). Lower target = earlier downshift.</td>
                <td>60 FPS: downshift at 18.8ms, upshift at 14.0ms. 30 FPS: downshift at 35.5ms, upshift at 30.7ms.</td>
            </tr>
            </tbody>
        </table>

        <h3>Quick Tuning Workflow</h3>
        <div style="background: #0d4a6e; padding: 12px; border-radius: 6px; margin: 12px 0;">
            <p><strong>Step 1: Start with preset</strong> - Choose PERFORMANCE, BALANCED, or QUALITY as baseline.</p>
            <p><strong>Step 2: Enable PERF MON</strong> - See where frame time is spent (raycast vs wall vs fog).</p>
            <p><strong>Step 3: Adjust one setting at a time</strong> - Change RAYS, test. Change DRAW DIST, test. Avoid changing multiple settings simultaneously.</p>
            <p><strong>Step 4: Watch adaptive behavior</strong> - If AUTO RAYS ON, monitor "80x3->60x4" shifts in PERF MON. Constant shifting indicates target is too ambitious.</p>
            <p><strong>Step 5: Find stable config</strong> - Goal: minimal adaptive shifting while maintaining target FPS.</p>
            <p><strong>Step 6: Save or document</strong> - Manual overrides show CUSTOM. Note settings for future reference.</p>
        </div>

        <h3>Common Issues & Solutions</h3>
        <table>
            <thead>
            <tr>
                <th style="width: 180px;">Symptom</th>
                <th>Diagnosis (via PERF MON)</th>
                <th>Solution</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="mono">Framerate constantly fluctuates</td>
                <td>Ray label shifting frequently (e.g., "60x4→48x5→60x4")</td>
                <td>Lower RAYS preset or reduce DRAW DIST. Adaptive is struggling to maintain stability.</td>
            </tr>
            <tr>
                <td class="mono">Sudden frame drops in certain areas</td>
                <td>Wall or fog timing spikes in PERF MON</td>
                <td>Reduce DRAW DIST or enable FAR TEX OFF 8-12 to limit textured wall count.</td>
            </tr>
            <tr>
                <td class="mono">Visual "popping" at medium distance</td>
                <td>MIP level distribution shows uneven spread (MP 0/50/30/20/0)</td>
                <td>Adjust MIP1-4 DIST to create smoother gradient (spread values evenly).</td>
            </tr>
            <tr>
                <td class="mono">Distant walls look too blurry</td>
                <td>High MIP3/MIP4 counts in PERF MON</td>
                <td>Raise MIP3/MIP4 DIST or reduce DRAW DIST. Consider MIP LOD OFF for testing.</td>
            </tr>
            <tr>
                <td class="mono">Game looks "washed out" or hazy</td>
                <td>Fog starting too early or too dense</td>
                <td>Raise FOG START (10→12) or FOG FULL (13→16). Try FOG COLOR BLACK for contrast.</td>
            </tr>
            <tr>
                <td class="mono">UI text hard to read</td>
                <td>UI_TXT_BG CLEAR with bright game behind text</td>
                <td>Set UI_TXT_BG SOLID or lower UI_TRANSP (35→25).</td>
            </tr>
            <tr>
                <td class="mono">Menu shows CUSTOM unexpectedly</td>
                <td>Manual override was accidentally changed</td>
                <td>Re-apply P/Q PRESET to reset to known configuration.</td>
            </tr>
            <tr>
                <td class="mono">Texture seams visible between columns</td>
                <td>WALL_TEX_SEAM_OVERDRAW or projection issue</td>
                <td>Toggle WALL PROJ STABLE for consistency. Check WALL1 FMT (should be PNG16).</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="card">
        <h2>Coverage Verification</h2>
        <p class="ok">All 55 menu items documented with performance impacts, use cases, and developer notes.</p>
        <p class="small">
            <strong>Core (13):</strong> PAGE, LOGS, ENEMIES, PROPS, BLOCK DBG, FPS TARGET, AUDIO MIX, RENDER, RAYCAST, PERF MON, AUTO RAYS, DBUF, BACK<br>
            <strong>Video (24):</strong> PAGE, TEXTURES, ROOF TEX, MIPMAP, MIP LOD, RAYS, DRAW DIST, FAR TEX OFF, MIP1-4 DIST, FOG START/FULL/CUT L/COLOR/DTHR, WALL RES, FPS OVL, MINIMAP, WALL1 FMT, WALL KEY, WALL PROJ, BACK<br>
            <strong>Perf/Q (18):</strong> PAGE, P/Q PRESET, WALL RES, RAYS, AUTO RAYS, DRAW DIST, FAR TEX OFF, MIPMAP, MIP LOD, FOG START/FULL/DTHR, UI TRANSP, UI TXT BG, FPS TARGET, PERF MON, DBUF, BACK
        </p>
    </div>

    <div class="card">
        <h2>Documentation Notes</h2>
        <p>This guide is code-verified against <span class="mono">app_full.lua</span> buildDebugMenuItems(), adjustDebugMenuSelection(), and applyPerfQualityPreset() functions.</p>
        <p class="warn">If debug menu structure changes in code, regenerate this guide to maintain accuracy.</p>
        <p class="small">
            <strong>Performance Impact Estimates:</strong> Based on ray count variance, texture memory, and algorithmic complexity. Actual impact varies by hardware, level geometry, and entity count.<br>
            <strong>Memory Estimates:</strong> Texture assets ~8-15 KB total. Double buffer adds ~3-8 KB frame buffer. Sprite memory excluded (varies by level).<br>
            <strong>Adaptive Ray Budget:</strong> EMA alpha=0.2, 18-frame cooldown, ±2.2/2.6ms hysteresis. Targets getAdaptiveRayTargetFrameUs() (16.67ms for 60 FPS).
        </p>
    </div>
</div>
</body>
</html>
